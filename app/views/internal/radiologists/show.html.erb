<div class="card">

    <div class="card-header">
        <strong>Radiologists</strong> - Radiologist Detail
    </div>

    <div class="card-body">

        <%=render "/shared/all_flash" %>
        <%= render 'shared/all_validation_flash', { model_obj: @radiologist } %>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :code %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.code %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :title %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.title.try(:name) %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :name, "Doctor Name" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.name %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :icno, "ICNO" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.icno %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :xray_facility_name, "X-Ray Facility Name" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.xray_facility_name %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :created_at, "Registration Date" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.created_at.try(:strftime,get_standard_date_format) || raw('<i>N/A</i>') %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :nationality_id, "Nationality" %>
                    <p class="form-control-plaintext">
                        <% if !@radiologist.nationality_id.blank? %>
                            <%= Country.find(@radiologist.nationality_id)&.name || raw('<i>N/A</i>') %>
                        <% end %>
                    </p>
                </div>
            </div> 
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :race_id, "Race/Ethnic" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.race&.name || raw('<i>N/A</i>') %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row"> 
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :gender, "Gender" %>
                    <p class="form-control-plaintext">
                    <% if @radiologist.gender=='M'%>
                         <p>Male</p>
                    <% elsif @radiologist.gender=='F' %>
                         <p>Female</p>
                    <% else @radiologist.gender== nil %>
                         <p>N/A</p>
                    <% end %>
                    </p>
                </div>
            </div>
        </div>

        <!-- address -->
        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <%= label_tag :address %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.address1 %>
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <p class="form-control-plaintext">
                        <%= @radiologist.address2 %>
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <p class="form-control-plaintext">
                        <%= @radiologist.address3 %>
                    </p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <p class="form-control-plaintext">
                        <%= @radiologist.address4 %>
                    </p>
                </div>
            </div>
        </div>
        <!-- /address -->

        <div class="row">
            <div class="col-md-4">
                <div class="form-group">
                    <%= label_tag :state %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.state.try(:name) %>
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <%= label_tag :postcode %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.postcode %>
                    </p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <%= label_tag :town %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.town.try(:name) %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :telephone_number, "Phone Number" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.phone %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :fax_number, "Fax Number" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.fax %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :mobile, "Mobile Number" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.mobile %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :email %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.email %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :qualification %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.qualification %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :is_pcr, "Is PCR" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.is_pcr ? 'Yes' : 'No' %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :is_panel_xray_facility, "Panel X-Ray Facility" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.is_panel_xray_facility ? 'Yes' : 'No' %>
                    </p>
                </div>
            </div>
            <% if @radiologist.is_panel_xray_facility %>
                <div class="col-md-6">
                    <div class="form-group">
                        <%= label_tag :is_panel_xray_facility, "X-Ray Facilities" %>
                        <ul class="list-parent" data-type="laboratory" id="laboratory-list">
                            <% @radiologist.panel_radiologists.each do |panel_radiologist| %>
                                <li><%= link_to "#{panel_radiologist.xray_facility.name} (#{panel_radiologist.xray_facility.code})", internal_xray_facility_path(panel_radiologist.xray_facility), target: "_BLANK" %></li>
                            <% end %>
                        </ul>
                    </div>
                </div>
            <% end %>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :apc_number, "APC Number" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.apc_number %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :apc_year, "APC Year" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.apc_year %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :nsr_number, "NSR Number" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.nsr_number %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :renewal_agreement_date, "Renewal Agreement Date" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.renewal_agreement_date %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="form-group">
                    <%= label_tag :district_health_office_id, "Nearest District Health Office" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.district_health_office.try(:name) %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :status %>
                    <p class="form-control-plaintext">
                        <%= Radiologist::STATUSES[@radiologist.status] %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :activated_at, "Activated At" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.activated_at.nil? ? (raw '<i>N/A</i>') : @radiologist.activated_at.strftime('%d/%m/%Y') %>
                    </p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :number_of_xray_clinics, "No. of associates X-ray clinics" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.xray_facilities.count %>
                    </p>
                </div>
            </div>
        </div>

        <% if @radiologist.status != 'ACTIVE' %>
        <div class="row">
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :status_reason, "Status (Reason)" %>
                    <p class="form-control-plaintext">
                        <%= Radiologist::ALL_STATUS_REASONS[@radiologist.status_reason] || raw('<i>N/A</i>') %>
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <%= label_tag :status_comment, "Status (Comment)" %>
                    <p class="form-control-plaintext">
                        <%= @radiologist.status_comment || raw('<i>N/A</i>') %>
                    </p>
                </div>
            </div>
        </div>
        <% end %>

    </div>
    <!-- /card-body -->

    <div class="card-footer">
        <style>
            form.button_to {
                display: inline;
            }
        </style>

        <div class="text-right">
            <%=raw show_back_button(internal_radiologists_path) %>

            <% if !@radiologist.registration_approved_at.nil? and @radiologist.activated_at.nil? %>
                <% if @radiologist.registration_paid? %>
                    <%= button_to "Activate", {action: 'activate', id: @radiologist.id}, {method: :patch, class: 'btn btn-sm btn-primary', data: {confirm: 'Confirm activate?'}} if has_permission?("ACTIVATE_RADIOLOGIST") %>
                <% else %>
                    <%=raw "<button type=\"button\" class=\"btn btn-sm btn-primary\" data-toggle=\"tooltip\" title=\"Pending payment\">Activate</button>" if has_permission?("ACTIVATE_RADIOLOGIST") %>
                    <%= link_to "Payment", edit_internal_order_path(@radiologist.registration_order), class: "btn btn-sm btn-primary" if has_permission?("VIEW_MSPD_ORDER") %>
                <% end %>
            <% end %>

            <% if can_request_update?(@radiologist) and has_any_permission?("EDIT_RADIOLOGIST") %>
                <%=raw show_edit_button edit_internal_radiologist_path(@radiologist) %>
            <% end %>

        </div>

    </div>

</div>

<div class="card">
    <div class="card-body">
        <ul class="list-group">
            <% if has_permission?("VIEW_DOCUMENT_RADIOLOGIST") %>
                <% if !@radiologist.registration_approved_at.nil? %>
                    <li class="list-group-item">
                        <%= link_to "Registration Letter", registration_letter_internal_radiologist_path(@radiologist) %> |
                        <%= link_to "Registration Invoice", registration_invoice_internal_radiologist_path(@radiologist), target: "_BLANK" %>
                    </li>
                    <li class="list-group-item"><%= link_to "Change Address Approval Letter", change_address_approval_internal_radiologist_path(@radiologist) %></li>
                <% end %>
            <% end %>

            <% if has_permission?("VIEW_STATUS_SCHEDULE") %>
                <li class="list-group-item">
                    <%= link_to "Status Schedules", internal_status_schedules_path(status_scheduleable_type: @radiologist.class.name, status_scheduleable_code: @radiologist.code) %>
                    | <%= link_to "Add", new_internal_status_schedule_path(status_scheduleable_type: @radiologist.class.name, status_scheduleable_code: @radiologist.code) %>
                </li>
            <% end %>

            <% if has_permission?("MSPD_REPORTS") %>
                <li class="list-group-item">
                    <%= link_to "Summary Loading Statistics", summary_loading_statistic_internal_radiologist_path(@radiologist) %>
                </li>
            <% end %>

            <% if has_permission?("VIEW_AUDIT_RADIOLOGIST") %>
                <li class="list-group-item">
                    <%= link_to "Audits", internal_radiologist_audits_path(@radiologist) %>
                </li>
            <% end %>
        </ul>
    </div>
</div>